#!/usr/bin/env bash

################################
# Shows AUR packages that need updated.
#
# Dependencies:
# - checkupdates
# - yaourt
# - notify-send
################################

full=""
short=""
color=""
status=0


archPackages=$(checkupdates)
allPackages=$(yaourt -Quaq)
numArchPackages=$(echo -n "$archPackages" | wc -l)
numAllPackages=$(echo -n "$allPackages" | wc -l)
numAurPackages=$(echo -n "$numAllPackages - $numArchPackages" | bc)

if [ $numAllPackages -le $numArchPackages ]; then
	numAurPackages=$numAllPackages
fi

full=$numAurPackages
short=$full


case $BLOCK_BUTTON in

	# right click: show packages
	# TODO: only show AUR packages
	3)
		aurPackages=$(diff -y <(echo "$archPackages") <(echo "$allPackages") | awk -p '{ print $3 }')
		notify-send "AUR packages" "$aurPackages"
	;;

esac


echo $full
echo $short
echo $color
exit $status
